<nav class="sidebar" (mouseenter)="onMouseEnter()" (mouseleave)="onMouseLeave()">
  <div
    class="item"
    (mouseenter)="onMouseEnterLibrary()"
    (mouseleave)="onMouseLeaveLibrary()"
    (click)="goToPlaylistHome($event)"
  >
    <span class="icon">*</span>
    <span class="label">Biblioteca</span>

    @if (isLibraryMenuOpen && isExpanded) {
    <div class="submenu library-submenu" (click)="$event.stopPropagation()">
      <button class="submenu-action" type="button" (click)="goToPlaylistHome($event)">
        Crear listas
      </button>

      @if (isLoggedIn) {
      @for (playlist of playlists(); track playlist.id) {
      <button class="submenu-item" type="button" (click)="openPlaylist(playlist.id, $event)">
        <span>{{ playlist.listName }}</span>
        <small>{{ playlist.songCount }}</small>
      </button>
      } @empty {
      <span class="submenu-empty">Sin listas creadas</span>
      }

      @if (librarySongs().length > 0) {
      <p class="submenu-heading">Canciones anadidas</p>
      @for (song of librarySongs(); track song.id) {
      <button
        class="library-song"
        type="button"
        (click)="playFromLibrary(song, $event)"
        [disabled]="!song.previewUrl"
      >
        <span>{{ song.title }}</span>
        <small>{{ song.artist }}</small>
      </button>
      }
      }
      } @else {
      <span class="submenu-empty">Inicia sesion para guardar playlists</span>
      }
    </div>
    }
  </div>

  <div class="item" routerLink="/profile">
    <span class="icon">*</span>
    <span class="label">Perfil</span>
  </div>

  <div class="item" (mouseenter)="onMouseEnterSearch()" (mouseleave)="onMouseLeaveSearch()">
    <span class="icon">*</span>
    <span class="label">Buscar</span>

    @if (isSearchMenuOpen) {
    <div class="submenu">
      <button routerLink="/tracks">Canciones</button>
    </div>
    }
  </div>
</nav>
